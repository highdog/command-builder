<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多语言系统测试</title>
    <script src="i18n.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .language-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            align-items: center;
        }
        
        .language-btn {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            color: #333;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .language-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            background: #f8f9fa;
        }
        
        .test-item {
            margin: 1rem 0;
            padding: 0.5rem;
            background: white;
            border-radius: 4px;
        }
        
        .nav-demo {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: #e9ecef;
            border-radius: 4px;
            margin: 1rem 0;
        }
        
        .nav-demo a {
            text-decoration: none;
            color: #007bff;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: white;
        }
        
        input[type="search"] {
            padding: 0.5rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin: 0.25rem;
        }
        
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 data-i18n="pageTitle">多语言系统测试</h1>
        
        <div class="language-toggle">
            <span>语言 / Language:</span>
            <button class="language-btn active" data-lang="zh">中文</button>
            <button class="language-btn" data-lang="en">English</button>
        </div>
        
        <div class="test-section">
            <h2>导航栏测试 / Navigation Test</h2>
            <div class="nav-demo">
                <a href="#" data-i18n="nav.commandBuilder">Command Builder</a>
                <a href="#" data-i18n="nav.documentation">Documentation</a>
            </div>
        </div>
        
        <div class="test-section">
            <h2>表单元素测试 / Form Elements Test</h2>
            <div class="test-item">
                <label data-i18n="main.protocolLabel">蓝牙协议:</label>
                <select>
                    <option data-i18n="protocols.gatt">GATT (BLE)</option>
                    <option data-i18n="protocols.rfcomm">RFCOMM</option>
                </select>
            </div>
            
            <div class="test-item">
                <label data-i18n="main.commandLabel">选择命令:</label>
                <select>
                    <option data-i18n="main.selectCommand">-- 请稍候 --</option>
                </select>
            </div>
            
            <div class="test-item">
                <input type="search" data-i18n="sidebar.searchPlaceholder" placeholder="搜索命令...">
            </div>
        </div>
        
        <div class="test-section">
            <h2>按钮测试 / Button Test</h2>
            <button data-i18n="main.copyButton">复制</button>
            <button data-i18n="actions.save">保存</button>
            <button data-i18n="actions.cancel">取消</button>
            <button data-i18n="actions.refresh">刷新</button>
        </div>
        
        <div class="test-section">
            <h2>消息测试 / Messages Test</h2>
            <div class="test-item">
                <strong data-i18n="messages.loading">正在加载...</strong>
            </div>
            <div class="test-item">
                <span data-i18n="messages.success">成功</span> | 
                <span data-i18n="messages.error">错误</span> | 
                <span data-i18n="messages.warning">警告</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>命令相关测试 / Command Related Test</h2>
            <div class="test-item">
                <span data-i18n="command.id">命令ID</span>: 0x07
            </div>
            <div class="test-item">
                <span data-i18n="command.name">命令名称</span>: <span data-i18n="command.description">命令描述</span>
            </div>
            <div class="test-item">
                <span data-i18n="command.payload">载荷</span> | 
                <span data-i18n="command.response">响应</span> | 
                <span data-i18n="command.example">示例</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>动态内容测试 / Dynamic Content Test</h2>
            <div class="test-item">
                <p id="dynamic-content" data-i18n="main.selectCommandDoc">请从左侧选择一个命令以查看其文档。</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>测试控制 / Test Controls</h2>
            <button onclick="testLanguageSwitch()">测试语言切换</button>
            <button onclick="testDynamicUpdate()">测试动态更新</button>
            <button onclick="showCurrentLanguage()">显示当前语言</button>
        </div>
        
        <div id="test-results" style="margin-top: 2rem; padding: 1rem; background: #e7f3ff; border-radius: 4px;">
            <h3>测试结果 / Test Results</h3>
            <div id="results-content">点击上方按钮开始测试...</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const languageButtons = document.querySelectorAll('.language-btn');
            const resultsContent = document.getElementById('results-content');
            
            // Set initial language state
            const currentLang = i18nManager.getCurrentLanguage();
            languageButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === currentLang);
            });
            
            // Apply initial language
            i18nManager.updatePageTexts();
            i18nManager.updateHtmlLang();
            
            // Language toggle functionality
            languageButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const newLang = btn.dataset.lang;
                    const oldLang = i18nManager.getCurrentLanguage();
                    
                    if (newLang !== oldLang) {
                        i18nManager.setLanguage(newLang);
                        
                        // Update button states
                        languageButtons.forEach(b => {
                            b.classList.toggle('active', b.dataset.lang === newLang);
                        });
                        
                        // Update all texts
                        i18nManager.updatePageTexts();
                        i18nManager.updateHtmlLang();
                        
                        resultsContent.innerHTML = `语言已切换: ${oldLang} → ${newLang}<br>Language switched: ${oldLang} → ${newLang}`;
                    }
                });
            });
            
            // Test functions
            window.testLanguageSwitch = () => {
                const currentLang = i18nManager.getCurrentLanguage();
                const newLang = currentLang === 'zh' ? 'en' : 'zh';
                
                // Simulate button click
                const targetBtn = document.querySelector(`[data-lang="${newLang}"]`);
                if (targetBtn) {
                    targetBtn.click();
                    resultsContent.innerHTML += `<br>自动切换测试完成: ${currentLang} → ${newLang}`;
                }
            };
            
            window.testDynamicUpdate = () => {
                const dynamicContent = document.getElementById('dynamic-content');
                const currentLang = i18nManager.getCurrentLanguage();
                
                // Test manual text update
                dynamicContent.textContent = i18nManager.t('messages.loadingCommands');
                
                setTimeout(() => {
                    dynamicContent.textContent = i18nManager.t('main.selectCommandDoc');
                    resultsContent.innerHTML += `<br>动态内容更新测试完成 (${currentLang})`;
                }, 1000);
            };
            
            window.showCurrentLanguage = () => {
                const currentLang = i18nManager.getCurrentLanguage();
                const htmlLang = document.documentElement.lang;
                const pageTitle = document.title;
                
                resultsContent.innerHTML += `<br>当前语言: ${currentLang}<br>HTML lang: ${htmlLang}<br>页面标题: ${pageTitle}`;
            };
            
            resultsContent.innerHTML = `多语言系统已初始化，当前语言: ${currentLang}`;
        });
    </script>
</body>
</html>
